# Курсовой проект по дисциплине "Информационные системы и базы данных"

### Предметная область

Кейс Чемпионат

### Описание

**Кейс-чемпионат** – это соревнование, во время которого участники, студенты и выпускники вузов, в командах решают бизнес-задачи. Эти задачи составляют партнеры чемпионата – крупные компании. Участникам разрешено обращаться за помощью к экспертам и тренерам. Представители компаний (члены жюри) оценивают результаты решения кейсов.

Традиционно кейс чемпионаты подразумевают поэтапную проработку командой отдельных частей одного проекта. Создаваемая база данных направлена на хранение промежуточных и итоговых данных “турнирной таблицы”, а также информации о судейской коллегии и наставниках команд.

Чемпионат проводиться только если набралась хотя бы одна судейская бригада, зарегистрировалась хотя бы одна команда, а также были найдены помещения для проведения данного чемпионата. 

Чтобы участник мог принять участие в чемпионате, то ему необходимо зарегистрироваться указав информацию о себе (имя, фамилию, дату рождения и хотя бы один действующий e-mail адрес).

Участником может стать любой человек не достигший 27 лет. Он не может быть при этом судьёй или тренером.

Тренером может стать любой человек достигший возраста 21 год. Также в его портфолио должна быть хотя бы одна научная публикация.

Команды участников состоят из 2-5 участников среди которых один капитан команды. Также у команды могут быть тренера (не больше 2).

Проект состоит из кейсов (не меньше одного), каждый кейс оценивается отдельно и имеет свою сложность, что влияет на итоговый результат. Максимальная оценка за один Кейс не превосходит 10 баллов. 

Выигрывает команда, набравшая максимальную сумму баллов за все свои Кейсы. 

Оценивание проектов происходит судейскими бригадами, состоящим из 3 судьей. Менторы не могут являться судьями.

Всё происходит на разных площадках в соответствии с расписанием. 

Таким образом совокупность всех таблиц направлена на помощь в выявлении победителей и призеров.

### ER-модель

![](images/ER-ER_v1.png)

### Даталогическая модель

![](images/ER-diagram.png)

### Текстовое описание сущностей

**Case**:
* `case_id` (id кейса);
* `description` (описание задания кейса);
* `complexity` (сложность кейса).

**Championship**:
* `championship_id` (id чемпионата);
* `name` (название чемпионата);
* `description` (описание чемпионата);
* `begin_date` (дата начала чемпионата);
* `end_date` (дата конца чемпионата).

**Email**:
* `email` (почтовый адрес);
* `person_id` (id человека из таблицы person, которому принадлежит данный почтовый адрес).

**Judge**:
* `person_id` (id человека из таблицы person, который является судьей);
* `championship_id` (id чемпионата из таблицы championship, судьей которого является данный человек);
* `work` (название компании в которой работает судья);
* `judge_team_id` (id судейской бригады из таблицы Judge_Team, частью которой является судья).

**Judge_Team**:
* `judge_team_id` (id судейской бригады);

**Mentor**:
* `person_id` (id человека из таблицы person,который является ментором);
* `championship_id` (id чемпионата из таблицы championship, ментором которого является данный человек).

**Participant**:
* `person_id` (id человека из таблицы person, который является участником);
* `championship_id` (id чемпионата из таблицы championship, участником которого является данный человек);
* `team_id` (id команды из таблицы team, участником которой является данный человек).

**People**:
* `person_id` (id человека);
* `first_name` (имя человека);
* `last_name` (фамилия человека);
* `birth_date` (дата рождения);
* `age` (возраст участника (вычисляется)).

**Performance**:
* `performance_id` (id перфоманса);
* `project_id` (id проекта из таблицы project);
* `performance_time` (время, затраченное командой на решение кейса);
* `judge_team_id` (id судейской бригады из таблицы judge_team, котораясудит данный проект);
* `platform_id` (id места проведения из таблицы platform);
* `points` (очки, заработанные командой).

**Phone**:
* `phone_number` (номер телефона);
* `person_id` (id человека из таблицы person, которому принадлежит данный номер телефона).

**Platform**:
* `platform_id` (id места проведения);
* `name` (название площадки);
* `address` (адрес площадки);
* `contact_person_id` (id человека из таблицы person, который является контактным лицом на площадке).

**Project**:
* `project_id` (id проекта);
* `name` (название проекта);
* `team_id` (id команды из таблицы team, которая делает данный проект);
* `description` (краткое описание проекта).

**Publication**:
* `publication_id` (id публикации);
* `name` (название публикации);
* `description` (аннотация статьи, её краткое содержание).

**Score**:
* `team_id` (id команды из таблицы team, баллы которой храним);
* `final_score` (финальные баллы команды);
* `place` (место в турнирной таблице);
* `special_award` (специальный приз).

**Team**:
* `team_id` (id команды);
* `name` (название команды);
* `leader_id` (id человека из таблицы participant, который является капитаном данной команды).

### Сценарии использования базы данных:

Из предназначения базы данных следуют основные пути её использования:
* Регистрация: 
    * участника;
    * судьи;
    * ментора;
* Создание команды.
* Оценка выступления команды; 
* Открытие чемпионата;
* Закрытие 

### Функции, триггеры, ограничения целостности

Эти опирации, а также проверки целостности данных реализованы при помощи функций.

**Функции**:
* `add_case_to_championship` - функция позволяет осуществлять добпавление информации о кейсах, представленых в чемпионате;
* `add_mentor_to_team` - функция позволяет осуществлять добавление ментора к команде;
* `add_publication` - функция позволяет осуществлять добавление связи можду авторами и публикацией;
* `end_championship` -функция позволяет осуществлять завершение чемпионата;
* `insert_championship` - функция позволяет осуществлять добавление информации о чемпионате;
* `insert_judge_team` - функция позволяет осуществлять добавление информации о судейской бригаде;
* `insert_participant` - функция позволяет осуществлять добавление участника чемпионата;
* `insert_project` - функция позволяет осуществлять добавление информации о проекте;
* `insert_publication` - функция позволяет осуществлять добавление информации о публикации;
* `insert_publication_with_authors` - функция позволяет осуществлять добавление публикации уже связанной с её авторами;
* `insert_team` - функция позволяет осуществлять добавление команды без связи с ментором;
* `insert_team_with_mentor` - функция позволяет осуществлять добавление команды вместе со связью с ментором;
* `rate_performance` - функция позволяет осуществлять оценивание выступления команды; 
* `start_championship` - функция позволяет осуществлять добавление нового чемпионата.

**Функции проверки комплексных ограничений целостности данных**:
* `check_cases` - функция обеспечивает проверку факта наличия хотябы одного кейса в конкретном чемпионате;
* `check_judge` - функция обеспечивает проверку факта соответствия характеристик человека (отвечает ли он заданным требованиям для того, чтобы стать судьей);
* `check_judge_only_update` - функция обеспечивает удаление судейской бригады в случае если судья покинул бригаду;
* `check_judge_teams` - функция обеспечивает провеку корректности состава судейской бригады;
* `check_mentor` - функция обеспечивает проверку факта соответствия характеристик человека (отвечает ли он заданным требованиям для того, чтобы стать ментором);
* `check_mentor_team_dependency` - функция обеспечивает проверку ьщжет ли ментор быть закреплен за данной командой (на один ли чемпионат они зарегистрированы);
* `check_participant` - функция обеспечивает проверку факта соответствия характеристик человека (отвечает ли он заданным требованиям для того, чтобы стать участником);
* `check_participant_only_update` - функция обеспечивает удаление команды участников в случае если её покидает хотя бы один участник;
* `check_performance` - функция обеспечивает проверку возможности выступать на данной платформе в рамках конкретного чемпионате;
* `check_performances` - функция обеспечивает проверку возможности выступления (есть платформа для выступления и хотя бы одна судейская бригада для оценки);
* `check_person_contact_info` - функция обеспечивает проверку наличия контактной информации о человеке, такой как адрес электронной почты и номер телефона;
* `check_platforms` - функция обеспечивает проверку наличия хотябы одной платформы у чемпионата;
* `check_projects` - функция обеспечивает провеку факта наличия в чемпионате хотябы одного проекта, включающего в себя кейсы данного чемпионата; 
* `check_teams` - функция обеспечивает проверку команды на соответствие правилам для уастия (от двух до пяти участников, один из которых является капитаном, не более двух менторов);

**Триггеры**:
* `checkJudie` - срабатывает при вызове функции addJudie и вызывает проверку корректности заполнения полей данных о судье;
* `checkMentor` - срабатывает при вызове функции addMentor и вызывает проверку корректности заполнения полей данных о менторе;
* `checkParticipant` - срабатывает при вызове функции addParticipant и вызывает проверку корректности заполнения полей данных об участнике;
* `checkTeam` - срабатывает при вызове функции createTeam и вызывает проверку корректности заполнения полей данных о менторе.

### Индексы

PostgreSQL автоматически создает hash-индексы для атрибутов `primary key`. В данной работе используются в основном провеки 
и сравнения именно по первичному ключу. Также ускорения взаимодеяствия с базой данных были дополнительно созданы btree-индексы:

**Индексы**:
* `championship_beginning_index` - btree индекс на атрибут `begin_date` таблицы `championship`, позволяющий ускорить опирации сравнения;
* `final_score_index` - btree индекс на атрибут `final_score` таблицы `score`, позволяющий ускорить опирации сравнения;
* `person_first_name_index` - btree индекс на атрибут `first_score` таблицы `people`, позволяющий ускорить опирации сравнения;
* `person_last_name_index` - btree индекс на атрибут `last_name` таблицы `people`, позволяющий ускорить опирации сравнения;
* `team_name_index` - btree индекс на атрибут `name` таблицы `team`, позволяющий ускорить опирации сравнения.
